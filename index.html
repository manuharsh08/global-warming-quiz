<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GK Quiz</title>
  <style>
    :root { --bg:#0f172a; --card:#111827; --text:#e5e7eb; --accent:#22c55e; --warn:#f59e0b; --err:#ef4444; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin:0; background:var(--bg); color:var(--text); }
    .wrap { max-width: 760px; margin: 2rem auto; padding: 1rem; }
    .card { background: var(--card); border-radius: 14px; padding: 1.25rem; box-shadow: 0 10px 24px rgba(0,0,0,0.25); }
    h1,h2 { margin: 0 0 0.5rem; }
    .muted { color:#9ca3af; font-size: 0.95rem; }
    .row { display:flex; justify-content: space-between; align-items:center; gap:1rem; }
    .q { font-weight: 600; margin: 1rem 0; }
    .opts { display:grid; gap:0.75rem; }
    .btn { background:#1f2937; color:var(--text); border:1px solid #374151; padding:0.75rem 1rem; border-radius:10px; cursor:pointer; text-align:left; transition: transform 0.02s ease; }
    .btn:hover { background:#273345; }
    .btn:active { transform: scale(0.995); }
    .btn.correct { background: #064e3b; border-color:#10b981; }
    .btn.wrong { background: #3f1d1d; border-color:#ef4444; }
    .controls { display:flex; gap:0.75rem; margin-top:1rem; }
    .pill { background:#0b1220; border:1px solid #334155; padding:0.4rem 0.65rem; border-radius:999px; font-size:0.9rem; }
    .accent { color: var(--accent); }
    .warn { color: var(--warn); }
    .err { color: var(--err); }
    .hidden { display:none; }
    .footer { margin-top:1rem; font-size:0.9rem; color:#94a3b8; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" id="screen-intro">
      <h1>General Knowledge Quiz</h1>
      <p class="muted">10 questions • 15 minutes • Instant feedback • One question at a time</p>
      <ul>
        <li>Score +1 for each correct answer.</li>
        <li>Change your choice until you click Next.</li>
        <li>Timer runs for the whole quiz; auto-submits at 0.</li>
      </ul>
      <div class="controls">
        <button id="startBtn" class="btn">Start Quiz</button>
      </div>
    </div>

    <div class="card hidden" id="screen-quiz" aria-live="polite">
      <div class="row">
        <div><span class="pill" id="progress">Q 1/10</span></div>
        <div class="pill">Time: <span id="timer">15:00</span></div>
      </div>
      <div class="q" id="questionText">Question text</div>
      <div class="opts" id="options"></div>
      <div id="feedback" class="muted"></div>
      <div class="controls">
        <button id="nextBtn" class="btn" disabled>Next</button>
      </div>
      <div class="footer">Tip: Use your reasoning first, then eliminate distractors.</div>
    </div>

    <div class="card hidden" id="screen-result">
      <h2>Results</h2>
      <p>Score: <span id="scoreText"></span>/10</p>
      <p id="timeUsed"></p>
      <div class="controls">
        <button id="retryBtn" class="btn">Retry</button>
      </div>
    </div>
  </div>

  <script>
    // Quiz data: question, options[4], answer index
    const QUESTIONS = [
      { q: 'Which planet is known as the Red Planet?', o: ['Venus','Mars','Jupiter','Mercury'], a: 1 },
      { q: 'The Great Barrier Reef is located off the coast of which country?', o: ['South Africa','Australia','Mexico','India'], a: 1 },
      { q: 'Who wrote “Romeo and Juliet”?', o: ['William Shakespeare','Charles Dickens','Jane Austen','Mark Twain'], a: 0 },
      { q: 'Which gas do plants primarily absorb for photosynthesis?', o: ['Oxygen','Nitrogen','Carbon dioxide','Hydrogen'], a: 2 },
      { q: 'The capital city of Japan is:', o: ['Seoul','Beijing','Kyoto','Tokyo'], a: 3 },
      { q: 'How many continents are there on Earth?', o: ['5','6','7','8'], a: 2 },
      { q: 'Which is the largest ocean on Earth?', o: ['Indian','Arctic','Atlantic','Pacific'], a: 3 },
      { q: 'Who painted the Mona Lisa?', o: ['Leonardo da Vinci','Pablo Picasso','Vincent van Gogh','Claude Monet'], a: 0 },
      { q: 'What is the chemical symbol for gold?', o: ['Ag','Au','Gd','Go'], a: 1 },
      { q: 'In which year did the first man land on the Moon?', o: ['1965','1969','1972','1959'], a: 1 },
    ];

    // Anti-accidental navigation and basic focus traps (not bulletproof anti-cheating)
    window.addEventListener('beforeunload', (e) => {
      if (!completed && started) { e.preventDefault(); e.returnValue = ''; }
    });
    document.addEventListener('keydown', (e) => {
      // Disable refresh/back shortcuts
      const k = e.key.toLowerCase();
      if ((e.ctrlKey || e.metaKey) && (k === 'r' || k === 'p' || k === 's')) e.preventDefault();
      if (k === 'f5' || (e.altKey && k === 'left')) e.preventDefault();
    });

    // State
    let idx = 0;
    let score = 0;
    let selected = null;
    let started = false;
    let completed = false;
    const QUIZ_SECONDS = 15 * 60; // 15 minutes
    let remaining = QUIZ_SECONDS;
    let timerId = null;

    // Elements
    const intro = document.getElementById('screen-intro');
    const quiz = document.getElementById('screen-quiz');
    const result = document.getElementById('screen-result');
    const qText = document.getElementById('questionText');
    const optionsBox = document.getElementById('options');
    const feedback = document.getElementById('feedback');
    const nextBtn = document.getElementById('nextBtn');
    const progress = document.getElementById('progress');
    const timer = document.getElementById('timer');
    const scoreText = document.getElementById('scoreText');
    const timeUsed = document.getElementById('timeUsed');

    function fmtTime(s) {
      const m = Math.floor(s / 60).toString().padStart(2, '0');
      const ss = (s % 60).toString().padStart(2, '0');
      return `${m}:${ss}`;
    }

    function startTimer() {
      timer.textContent = fmtTime(remaining);
      timerId = setInterval(() => {
        remaining--;
        timer.textContent = fmtTime(remaining);
        if (remaining <= 60) timer.parentElement.classList.add('warn');
        if (remaining <= 0) { clearInterval(timerId); submit(); }
      }, 1000);
    }

    function show(idx) {
      const { q, o } = QUESTIONS[idx];
      qText.textContent = q;
      progress.textContent = `Q ${idx + 1}/${QUESTIONS.length}`;
      optionsBox.innerHTML = '';
      feedback.textContent = '';
      nextBtn.disabled = true;
      selected = null;

      o.forEach((opt, i) => {
        const b = document.createElement('button');
        b.className = 'btn';
        b.textContent = opt;
        b.setAttribute('data-index', i);
        b.addEventListener('click', () => choose(i, b));
        optionsBox.appendChild(b);
      });
    }

    function choose(i, button) {
      // Clear previous selection styles
      [...optionsBox.children].forEach(ch => ch.classList.remove('correct','wrong'));
      selected = i;
      nextBtn.disabled = false;
      feedback.textContent = 'Locked? Click Next to confirm.';
    }

    function confirmAndMark() {
      if (selected === null) return;
      const correct = QUESTIONS[idx].a;
      [...optionsBox.children].forEach((btn, i) => {
        if (i === correct) btn.classList.add('correct');
        if (i === selected && i !== correct) btn.classList.add('wrong');
        btn.disabled = true;
      });
      if (selected === correct) {
        score++; feedback.textContent = 'Correct!';
      } else {
        feedback.innerHTML = `Incorrect. Correct answer: <span class="accent">${QUESTIONS[idx].o[correct]}</span>`;
      }
    }

    function next() {
      confirmAndMark();
      setTimeout(() => {
        idx++;
        if (idx < QUESTIONS.length) {
          show(idx);
        } else {
          submit();
        }
      }, 500);
    }

    function submit() {
      completed = true;
      clearInterval(timerId);
      quiz.classList.add('hidden');
      result.classList.remove('hidden');
      scoreText.textContent = score;
      const used = QUIZ_SECONDS - Math.max(0, remaining);
      timeUsed.textContent = `Time used: ${fmtTime(used)}`;

      // Trigger Safe Exam Browser auto-quit (SEB must be configured with the same Quit URL)
      window.location.assign("https://manuharsh08.github.io/global-warming-quiz/quit");
    }

    // Event wiring
    document.getElementById('startBtn').addEventListener('click', () => {
      started = true; idx = 0; score = 0; remaining = QUIZ_SECONDS; completed = false;
      intro.classList.add('hidden');
      result.classList.add('hidden');
      quiz.classList.remove('hidden');
      show(idx);
      startTimer();
      history.pushState(null, '', location.href);
    });

    document.getElementById('nextBtn').addEventListener('click', next);
    document.getElementById('retryBtn').addEventListener('click', () => {
      intro.classList.remove('hidden');
      quiz.classList.add('hidden');
      result.classList.add('hidden');
    });

    // Block back navigation during quiz session
    window.addEventListener('popstate', (e) => {
      if (started && !completed) history.pushState(null, '', location.href);
    });
  </script>
</body>
</html>
