<!DOCTYPE html>
<html>
<head>
  <title>Global Warming Quiz</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
    .center-screen {
      display: flex; flex-direction: column; justify-content: center; align-items: center;
      min-height: 100vh; background: #eaf5ea; padding: 20px; box-sizing: border-box;
      text-align: center;
      -webkit-user-select: none;  /* Disable text selection in Safari/Chrome */
      -moz-user-select: none;     /* Disable text selection in Firefox */
      -ms-user-select: none;      /* Disable text selection in IE/Edge */
      user-select: none;          /* Standard syntax */
    }
    .quiz-container {
      display: none; margin: 40px; max-width: 800px;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }
    h2 { color: #2E8B57; }
    .timer { font-size: 1.5em; font-weight: bold; color: #b22222; margin-bottom: 15px; }
    .question { margin-bottom: 20px; }
    .feedback { font-weight: bold; margin-top: 5px; }
    .correct { color: #2e8b57; }
    .incorrect { color: #d2691e; }
    .result { font-weight: bold; color: #d2691e; margin-top: 20px; }
    button { margin-top: 20px; font-size: 1.1em; padding: 10px 20px; cursor: pointer; }
    .disabled { pointer-events: none; opacity: 0.6; }
    ul { text-align: left; display: inline-block; margin: 0 auto; padding-left: 20px; }
    #tabSwitchWarning {
      font-weight: bold;
      color: #d2691e;
      margin-top: 15px;
    }
    /* Extra: make all form text unselectable */
    label, input, .question, .feedback, .timer, .result {
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }
  </style>
</head>
<body>
  <!-- Intro Screen -->
  <div class="center-screen" id="introScreen">
    <h1>Welcome to the Global Warming Quiz</h1>
    <p>You are about to take a quiz on <b>global warming</b>.</p>
    <p>
      <b>Rules:</b>
      <ul>
        <li>You will have <b>4 minutes</b> to complete 10 questions.</li>
        <li>The quiz will begin in fullscreen mode to ensure fairness.</li>
        <li><b>If you exit fullscreen at any time, the quiz will be automatically submitted immediately.</b></li>
        <li><b>Tab switching is strictly prohibited.</b> If you switch tabs or change the browser window, the quiz will be automatically submitted.</li>
        <li><b>Copying of quiz content is disabled.</b></li>
      </ul>
    </p>
    <p id="tabSwitchWarning">⚠️ This quiz is protected against cheating. Please remain on this tab and stay in fullscreen mode until you finish the quiz.</p>

    <!-- Input fields for name and email -->
    <div style="margin-top: 20px; text-align: left; max-width: 400px; width: 100%;">
      <label for="userName" style="font-weight: bold;">Name:</label><br>
      <input type="text" id="userName" name="userName" placeholder="Enter your full name" style="width: 100%; padding: 8px; box-sizing: border-box; margin-bottom: 15px;"><br>
      <label for="userEmail" style="font-weight: bold;">Email Address:</label><br>
      <input type="email" id="userEmail" name="userEmail" placeholder="Enter your email address" style="width: 100%; padding: 8px; box-sizing: border-box; margin-bottom: 15px;">
    </div>
    <!-- Error message container -->
    <div id="inputError" style="color: #d2691e; font-weight: bold; margin-bottom: 10px; display: none;"></div>
    <button id="startBtn" onclick="startQuiz()">Start Quiz</button>
  </div>
  
  <!-- Quiz Container -->
  <div class="quiz-container" id="quizContainer">
    <h2>Global Warming Quiz</h2>
    <div class="timer" id="timer">Time left: 04:00</div>
    <form id="quizForm">
      <!-- ... (questions 1-10 remain unchanged) ... -->
      <div class="question" id="qdiv1">
        <p>1. What is the primary gas responsible for global warming?</p>
        <input type="radio" name="q1" value="a"> Oxygen<br>
        <input type="radio" name="q1" value="b"> Nitrogen<br>
        <input type="radio" name="q1" value="c"> Carbon Dioxide<br>
        <input type="radio" name="q1" value="d"> Hydrogen<br>
        <div class="feedback" id="feedback1"></div>
      </div>
      <!-- ... repeat for other questions ... -->
      <div class="question" id="qdiv10">
        <p>10. What can melting polar ice caps cause?</p>
        <input type="radio" name="q10" value="a"> Sea level rise<br>
        <input type="radio" name="q10" value="b"> Air temperature drop<br>
        <input type="radio" name="q10" value="c"> Less ocean water<br>
        <input type="radio" name="q10" value="d"> More deserts<br>
        <div class="feedback" id="feedback10"></div>
      </div>
      <button type="button" id="submitBtn" onclick="checkAnswers()">Submit Answers</button>
    </form>
    <div class="result" id="result"></div>
  </div>

<script>
  let timer = 240; // seconds
  let timerInterval;
  let quizSubmitted = false;

  // --- Uncopiable logic ---
  // Disable right-click everywhere
  document.addEventListener('contextmenu', function(e) {
    e.preventDefault();
    return false;
  });
  // Disable text selection explicitly (redundant with CSS but covers more scenarios)
  document.addEventListener('selectstart', function(e) {
    e.preventDefault();
    return false;
  });
  // Disable common copy keyboard shortcuts
  document.addEventListener('keydown', function(e) {
    // Prevent Ctrl+C, Ctrl+X, Ctrl+A, Ctrl+S and their Mac equivalents
    if ((e.ctrlKey || e.metaKey) && ['c', 'x', 'a', 's'].includes(e.key.toLowerCase())) {
      e.preventDefault();
      return false;
    }
  });
  // Disable copy-related clipboard events
  document.addEventListener('copy', function(e) {
    e.preventDefault();
    return false;
  });
  document.addEventListener('cut', function(e) {
    e.preventDefault();
    return false;
  });
  // --- End uncopiable logic ---

  function goFullScreen(elem) {
    if (elem.requestFullscreen) elem.requestFullscreen();
    else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
    else if (elem.msRequestFullscreen) elem.msRequestFullscreen();
  }

  function autoSubmitQuizOnFullScreenExit() {
    if (quizSubmitted) return;
    alert('You exited fullscreen. The quiz will now be submitted.');
    checkAnswers(true);
  }

  document.addEventListener('fullscreenchange', function() {
    if (!document.fullscreenElement && document.getElementById('quizContainer').style.display === 'block') {
      autoSubmitQuizOnFullScreenExit();
    }
  });

  document.addEventListener('visibilitychange', function() {
    if (!quizSubmitted && document.getElementById('quizContainer').style.display === 'block' && document.hidden) {
      alert('You switched tabs or minimized the browser. The quiz will now be submitted.');
      checkAnswers(true);
    }
  });

  function startQuiz() {
    const nameInput = document.getElementById('userName').value.trim();
    const emailInput = document.getElementById('userEmail').value.trim();
    const errorDiv = document.getElementById('inputError');

    if (nameInput === '') {
      errorDiv.textContent = "Please enter your name.";
      errorDiv.style.display = "block";
      return;
    }
    if (emailInput === '') {
      errorDiv.textContent = "Please enter your email address.";
      errorDiv.style.display = "block";
      return;
    }
    const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailPattern.test(emailInput)) {
      errorDiv.textContent = "Please enter a valid email address.";
      errorDiv.style.display = "block";
      return;
    }

    errorDiv.style.display = "none";

    document.getElementById('introScreen').style.display = 'none';
    document.getElementById('quizContainer').style.display = 'block';
    timer = 240;
    quizSubmitted = false;
    startTimer();
    goFullScreen(document.documentElement);
  }

  function startTimer() {
    updateTimerDisplay();
    timerInterval = setInterval(() => {
      timer--;
      updateTimerDisplay();
      if (timer <= 0) {
        clearInterval(timerInterval);
        if (!quizSubmitted) {
          checkAnswers(true);
        }
      }
    }, 1000);
  }

  function updateTimerDisplay() {
    const min = Math.floor(timer / 60);
    const sec = timer % 60;
    document.getElementById('timer').textContent =
      `Time left: ${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
  }

  // --- Formspree Integration ---
  function sendToFormspree(name, email, score) {
    // Replace the endpoint URL below with your actual Formspree URL
    const endpoint = "https://formspree.io/f/xyzppvla";

    fetch(endpoint, {
      method: "POST",
      headers: { "Content-Type": "application/json", "Accept": "application/json" },
      body: JSON.stringify({
        name: name,
        email: email,
        score: score
      })
    })
    .then(response => {
      if (response.ok) {
        console.log("Quiz result sent to Formspree.");
      } else {
        console.error("Formspree submission failed.");
      }
    })
    .catch(error => {
      console.error("Formspree submission error:", error);
    });
  }
  // -----------------------------

  function checkAnswers(auto = false) {
    if (quizSubmitted) return;

    const answers = ['c', 'b', 'c', 'a', 'c', 'a', 'b', 'b', 'a', 'a'];
    const ansText = [
      "Carbon Dioxide",
      "Combustion of Fossil Fuels",
      "Energy Production",
      "Paris Agreement",
      "Increase",
      "Solar",
      "Planting Trees",
      "Global Warming",
      "Using public transport",
      "Sea level rise"
    ];

    let score = 0;
    let allAnswered = true;

    for (let i = 1; i <= 10; i++) {
      document.getElementById('feedback' + i).innerHTML = "";
      const radios = document.getElementsByName('q' + i);
      let answered = false;
      let userVal = "";

      for (const radio of radios) {
        if (radio.checked) {
          answered = true;
          userVal = radio.value;
          if (radio.value === answers[i - 1]) score++;
        }
      }

      if (!answered) allAnswered = false;

      if (userVal === answers[i - 1]) {
        document.getElementById('feedback' + i).innerHTML = "<span class='correct'>Correct!</span>";
      } else {
        document.getElementById('feedback' + i).innerHTML =
          "<span class='incorrect'>Incorrect. Correct answer: <b>" + ansText[i - 1] + "</b></span>";
      }
    }

    if (!allAnswered && !auto) {
      document.getElementById('result').textContent = "Please answer all questions!";
      for (let j = 1; j <= 10; j++) {
        const fb = document.getElementById('feedback' + j);
        if (fb) fb.innerHTML = "";
      }
      return;
    }

    quizSubmitted = true;
    clearInterval(timerInterval);
    Array.from(document.querySelectorAll('input[type=radio]')).forEach(e => e.disabled = true);
    const submitBtn = document.getElementById('submitBtn');
    submitBtn.disabled = true;
    submitBtn.classList.add('disabled');

    // Send user info + score to Formspree
    const name = document.getElementById('userName').value.trim();
    const email = document.getElementById('userEmail').value.trim();
    sendToFormspree(name, email, score);

    if (auto && !allAnswered) {
      document.getElementById('result').textContent = "Time's up or quiz submitted early! You scored " + score + " out of 10.";
    } else {
      document.getElementById('result').textContent = "You scored " + score + " out of 10.";
    }
  }

  window.onload = function () {
    document.getElementById('quizContainer').style.display = 'none';
    document.getElementById('introScreen').style.display = 'flex';
  };
</script>
</body>
</html>

